(this["webpackJsonpcontext-purchases"]=this["webpackJsonpcontext-purchases"]||[]).push([[0],{14:function(e,t,r){},16:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r.n(n),c=r(6),o=r.n(c),l=(r(14),r(8)),s=r(4),u=r(2),i=Object(n.createContext)(),p={posts:{items:[],loading:!1,error:null},editedPost:{item:{id:0,price:"",category:"food",description:""},loading:!1,error:null},removedPost:{id:0,loading:!1,error:null},description:{id:0,value:"",loading:!1,error:null},totalSum:0};function E(e,t){switch(t.type){case"FETCH_POST_REQUEST":return Object(u.a)({},e,{loading:!0,error:null});case"FETCH_POST_SUCCESS":return{items:t.payload.posts,loading:!1,error:null};case"FETCH_POST_FAILURE":return Object(u.a)({},e,{loading:!1,error:t.payload.error});default:return e}}function d(e,t){switch(t.type){case"EDIT_POST_CHANGE_FIELD":return Object(u.a)({},e,{item:Object(u.a)({},e.item,Object(s.a)({},t.payload.name,t.payload.value))});case"EDIT_POST_REQUEST":return Object(u.a)({},e,{loading:!0,error:null});case"EDIT_POST_SUCCESS":return{item:{id:0,price:"",category:"Food",description:""},loading:!1,error:null};case"EDIT_POST_FAILURE":return Object(u.a)({},e,{loading:!1,error:t.payload.error});case"EDIT_POST_CANCEL":return{item:{id:0,price:"",category:"Food",description:""},loading:!1,error:null};case"EDIT_EXISTING_POST":return{item:Object(u.a)({},t.payload.item),loading:!1,error:null};default:return e}}function O(e,t){switch(t.type){case"REMOVE_MEMO_FIRST":return{id:t.payload.id,loading:!1,error:null};case"REMOVE_MEMO_CANCEL":return{id:0,loading:!1,error:null};case"REMOVE_POST_REQUEST":return Object(u.a)({},e,{loading:!0,error:null});case"REMOVE_POST_SUCCESS":return{id:0,loading:!1,error:null};case"REMOVE_POST_ERROR":return Object(u.a)({},e,{loading:!1,error:t.payload.error});default:return e}}function S(e,t){switch(t.type){case"ADD_TO_TOTAL_SUM":return e+t.payload.price;case"SUBTRACT_FROM_TOTAL_SUM":return e-t.payload.price;case"CHANGE_TOTAL_SUM":return e+t.payload.price;default:return e}}function _(e,t){switch(t.type){case"SHOW_DESCRIPTION_REQUEST":return console.log("req"),Object(u.a)({},e,{loading:!0,error:null});case"SHOW_DESCRIPTION_SUCCESS":return Object(u.a)({},e,{id:t.payload.id,value:t.payload.desc,loading:!1,error:null});case"SHOW_DESCRIPTION_FAILURE":return console.log("fai"),Object(u.a)({},e,{loading:!1,error:t.payload.error});default:return e}}function m(e,t){switch(t.type){case"FETCH_POST_REQUEST":case"FETCH_POST_SUCCESS":case"FETCH_POST_FAILURE":return Object(u.a)({},e,{posts:E(e.posts,t)});case"EDIT_POST_CHANGE_FIELD":case"EDIT_POST_REQUEST":case"EDIT_POST_SUCCESS":case"EDIT_POST_FAILURE":case"EDIT_POST_CANCEL":case"EDIT_EXISTING_POST":return Object(u.a)({},e,{editedPost:d(e.editedPost,t)});case"REMOVE_MEMO_FIRST":case"REMOVE_MEMO_CANCEL":case"REMOVE_POST_REQUEST":case"REMOVE_POST_SUCCESS":case"REMOVE_POST_ERROR":return Object(u.a)({},e,{removedPost:O(e.removedPost,t)});case"ADD_TO_TOTAL_SUM":case"SUBTRACT_FROM_TOTAL_SUM":case"CHANGE_TOTAL_SUM":return Object(u.a)({},e,{totalSum:S(e.totalSum,t)});case"SHOW_DESCRIPTION_REQUEST":case"SHOW_DESCRIPTION_SUCCESS":case"SHOW_DESCRIPTION_FAILURE":return Object(u.a)({},e,{description:_(e.description,t)});default:return e}}function f(e){var t=Object(n.useReducer)(m,p),r=Object(l.a)(t,2),c=r[0],o=r[1];return a.a.createElement(i.Provider,{value:{state:c,dispatch:o}},e.children)}var T=r(1),y=r.n(T),h=r(3);function b(e){return{type:"FETCH_POST_SUCCESS",payload:{posts:e}}}function v(e){return{type:"FETCH_POST_FAILURE",payload:{error:e}}}function C(e){return g.apply(this,arguments)}function g(){return(g=Object(h.a)(y.a.mark((function e(t){var r,n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t({type:"FETCH_POST_REQUEST",payload:{}}),e.prev=1,e.next=4,fetch("https://requeststaha.herokuapp.com/api/posts");case 4:if((r=e.sent).ok){e.next=7;break}throw new Error("Wrong Request");case 7:return e.next=9,r.json();case 9:n=e.sent,t(b(n)),e.next=17;break;case 13:throw e.prev=13,e.t0=e.catch(1),t(v(e.t0)),e.t0;case 17:case"end":return e.stop()}}),e,null,[[1,13]])})))).apply(this,arguments)}function R(e,t){return I.apply(this,arguments)}function I(){return(I=Object(h.a)(y.a.mark((function e(t,r){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(P()),e.prev=1,e.next=4,fetch("https://requeststaha.herokuapp.com/api/posts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});case 4:if(e.sent.ok){e.next=7;break}throw new Error("error");case 7:t(x()),e.next=14;break;case 10:throw e.prev=10,e.t0=e.catch(1),t(U(e.t0)),e.t0;case 14:case"end":return e.stop()}}),e,null,[[1,10]])})))).apply(this,arguments)}function P(){return{type:"EDIT_POST_REQUEST",payload:{}}}function x(){return{type:"EDIT_POST_SUCCESS",payload:{}}}function U(e){return{type:"EDIT_POST_FAILURE",payload:{error:e}}}function D(e,t){return w.apply(this,arguments)}function w(){return(w=Object(h.a)(y.a.mark((function e(t,r){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(k()),e.prev=1,e.next=4,fetch("https://requeststaha.herokuapp.com/api/posts/".concat(r),{method:"DELETE"});case 4:if(e.sent.ok){e.next=7;break}throw new Error("error");case 7:t(M()),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),t(A(e.t0));case 13:case"end":return e.stop()}}),e,null,[[1,10]])})))).apply(this,arguments)}function k(){return{type:"REMOVE_POST_REQUEST",payload:{}}}function M(){return{type:"REMOVE_POST_SUCCESS",payload:{}}}function A(e){return{type:"REMOVE_POST_ERROR",payload:{error:e}}}function j(e){return{type:"SUBTRACT_FROM_TOTAL_SUM",payload:{price:e}}}function F(e,t){return{type:"CHANGE_TOTAL_SUM",payload:{price:t-e}}}function N(e,t){return L.apply(this,arguments)}function L(){return(L=Object(h.a)(y.a.mark((function e(t,r){var n,a;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(H()),e.prev=1,e.next=4,fetch("https://requeststaha.herokuapp.com/api/posts/desc/".concat(r));case 4:if((n=e.sent).ok){e.next=8;break}throw console.log("help me2"),new Error("error");case 8:return e.next=10,n.text();case 10:a=e.sent,console.log(a),t(V(r,a)),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(1),t(W(e.t0));case 18:case"end":return e.stop()}}),e,null,[[1,15]])})))).apply(this,arguments)}function H(){return{type:"SHOW_DESCRIPTION_REQUEST",payload:{}}}function V(e,t){return{type:"SHOW_DESCRIPTION_SUCCESS",payload:{id:e,desc:t}}}function W(e){return{type:"SHOW_DESCRIPTION_FAILURE",payload:{error:e}}}var Q=r(7),G=r.n(Q);function B(){return a.a.createElement("img",{src:G.a,alt:""})}function q(e){var t=e.item,r=Object(n.useContext)(i),c=r.state,o=c.removedPost,l=c.description,s=r.dispatch;function u(e){return p.apply(this,arguments)}function p(){return(p=Object(h.a)(y.a.mark((function e(r){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),e.prev=1,e.next=4,D(s,t.id);case 4:return e.next=6,C(s);case 6:s(j(parseInt(t.price,10))),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})))).apply(this,arguments)}function E(e){e.preventDefault(),s({type:"REMOVE_MEMO_FIRST",payload:{id:t.id}})}function d(e){e.preventDefault(),s({type:"REMOVE_MEMO_CANCEL",payload:{}})}function O(e){e.preventDefault(),s(function(e){return{type:"EDIT_EXISTING_POST",payload:{item:e}}}(t))}function S(){return(S=Object(h.a)(y.a.mark((function e(r){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),e.prev=1,e.next=4,N(s,t.id);case 4:return e.next=6,C(s);case 6:e.next=10;break;case 8:e.prev=8,e.t0=e.catch(1);case 10:case"end":return e.stop()}}),e,null,[[1,8]])})))).apply(this,arguments)}return Object(n.useEffect)((function(){s({type:"ADD_TO_TOTAL_SUM",payload:{price:parseInt(t.price,10)}})}),[s,t.price]),a.a.createElement("div",{className:"card text-center col-5"},o.loading?a.a.createElement(B,null):o.id!==t.id?a.a.createElement("div",null,a.a.createElement("button",{class:"btn btn-success",href:"",onClick:O},"edit"),a.a.createElement("button",{class:"btn btn-danger",href:"",onClick:E},"delete")):o.error?a.a.createElement("div",null,a.a.createElement("p",null,"Error occured. Retry?"),a.a.createElement("button",{class:"btn btn-success",href:"",onClick:u},"Yes"),a.a.createElement("button",{class:"btn btn-danger",href:"",onClick:d},"No")):a.a.createElement("div",null,"Are you sure, you want to delete this post?",a.a.createElement("button",{class:"btn btn-success",href:"",onClick:u},"Yes"),a.a.createElement("button",{class:"btn btn-danger",href:"",onClick:d},"No")),a.a.createElement("div",{class:"card-header"},a.a.createElement("p",null,"Category: ",t.category)),a.a.createElement("p",null,"Price: ",t.price),a.a.createElement("button",{class:"btn btn-info",o:!0,nClick:function(e){return S.apply(this,arguments)}},"Show Description"),l.loading&&a.a.createElement(B,null),t.id===l.id&&a.a.createElement("div",{class:"card"},a.a.createElement("div",{class:"card-body"},l.value)))}function J(){var e=Object(n.useContext)(i),t=e.state,r=e.dispatch,c=t.posts,o=c.items,l=c.loading,s=c.error;function u(){return(u=Object(h.a)(y.a.mark((function e(){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,C(r);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})))).apply(this,arguments)}Object(n.useEffect)((function(){Object(h.a)(y.a.mark((function e(){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,C(r);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})))()}),[r]);var p=a.a.createElement(a.a.Fragment,null,a.a.createElement("p",null,"Error occured"),a.a.createElement("button",{onClick:function(){return u.apply(this,arguments)}},"retry"));return a.a.createElement("div",null,l&&a.a.createElement(B,null),o.map((function(e){return a.a.createElement(q,{key:e.id,item:e})})),a.a.createElement("span",null,"total sum: "),t.totalSum,s&&p)}function X(){var e=Object(n.useContext)(i),t=e.state,r=e.dispatch,c=t.editedPost,o=c.item,l=c.loading,s=c.error,u=0;function p(){return(p=Object(h.a)(y.a.mark((function e(n){var a;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.prev=1,e.next=4,R(r,o);case 4:return e.next=6,C(r);case 6:a=t.posts.items.find((function(e){return e.id===o.id})),u=parseInt(a.price,10),r(F(u,parseInt(o.price,10))),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),console.log(e.t0);case 14:case"end":return e.stop()}}),e,null,[[1,11]])})))).apply(this,arguments)}var E=function(e){var t=e.target,n=t.name,a=t.value;r(function(e,t){return{type:"EDIT_POST_CHANGE_FIELD",payload:{name:e,value:t}}}(n,a))};return a.a.createElement("form",{onSubmit:function(e){return p.apply(this,arguments)},onReset:function(){r({type:"EDIT_POST_CANCEL",payload:{}})}},a.a.createElement("div",{class:"input-group mb-3"},a.a.createElement("div",{class:"input-group-prepend"},a.a.createElement("span",{class:"input-group-text",id:"basic-addon1"},"Price:")),a.a.createElement("input",{name:"price",type:"text",class:"form-control col-3",placeholder:"Price",onChange:E,value:o.price,"aria-label":"Username","aria-describedby":"basic-addon1"})),a.a.createElement("div",{class:"input-group mb-3"},a.a.createElement("div",{class:"input-group-prepend"},a.a.createElement("label",{class:"input-group-text",for:"inputGroupSelect01"},"Category")),a.a.createElement("select",{class:"custom-select col-2",name:"category",id:"category",onChange:E,value:o.category},a.a.createElement("option",{selected:!0},"Choose..."),a.a.createElement("option",{value:"Food"},"Food"),a.a.createElement("option",{value:"Travel"},"Travel"),a.a.createElement("option",{value:"Beauty"},"Beauty"))),a.a.createElement("div",{class:"input-group mb-3"},a.a.createElement("div",{class:"input-group-prepend "},a.a.createElement("span",{class:"input-group-text"},"Description")),a.a.createElement("textarea",{name:"description",placeholder:"description",value:o.description,onChange:E,class:"form-control col-5","aria-label":"With textarea"})),l?a.a.createElement(B,null):s?a.a.createElement(a.a.Fragment,null,a.a.createElement("span",null,"Error occured"),a.a.createElement("button",null,"Retry"),a.a.createElement("button",{type:"reset"},"Cancel")):a.a.createElement(a.a.Fragment,null,a.a.createElement("button",{className:"btn btn-success"},0===o.id?"Add":"Save"),a.a.createElement("button",{class:"btn btn-danger",type:"reset"},"cancel")))}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(a.a.createElement((function(){return a.a.createElement("div",null,a.a.createElement(f,null,a.a.createElement(X,null),a.a.createElement(J,null)))}),null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},7:function(e,t,r){e.exports=r.p+"static/media/45.fec456b1.gif"},9:function(e,t,r){e.exports=r(16)}},[[9,1,2]]]);
//# sourceMappingURL=main.102433c1.chunk.js.map